{"ast":null,"code":"import _defineProperty from \"/Users/yangkin/Desktop/project/react/todolist_koa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nconst commonUrl = 'http://127.0.0.1:3100';\nlocalStorage.setItem(\"access_token\", \"test\");\n\nfunction parseJSON(response) {\n  return response.json();\n}\n\nfunction checkStatus(response) {\n  if (response.status >= 200 && response.status < 500) {\n    return response;\n  }\n\n  const error = new Error(response.statusText);\n  error.response = response;\n  throw error;\n}\n/**\n * 登录请求\n * \n * @param data 数据\n */\n\n\nexport function loginReq(data) {\n  const options = {};\n  options.method = 'post';\n  options.made = 'cors';\n  options.body = JSON.stringify(data);\n  options.headers = {\n    'Content-Type': 'application/json'\n  };\n  return fetch('/loginOk', options, {\n    credentials: 'include'\n  }).then(checkStatus).then(parseJSON).then(res => {\n    if (res.retCode === '0001') {\n      localStorage.setItem('x-access-token', res.retBody.AccessToken);\n      return 'success';\n    } else if (res.retCode === '0002') {\n      return 'error';\n    } else if (res.retCode === '0003') {\n      return 'error';\n    } else {\n      return;\n    }\n  }).catch(err => ({\n    err\n  }));\n}\n/**\n * 普通请求\n * @param {*url,*method,*data} options \n */\n\nexport default function reqwest(options = {}) {\n  // const Authorization = localStorage.getItem('access_token')\n  const _options = options,\n        data = _options.data,\n        url = _options.url;\n  options = _objectSpread({}, options);\n  options.mode = 'cors';\n  delete options.url;\n\n  if (data) {\n    delete options.data;\n    options.body = JSON.stringify({\n      data\n    });\n  }\n\n  options.headers = {\n    'Access-Control-Allow-Origin': '*',\n    // 'Authorization':Authorization,\n    // 'Accept': 'application/json, text/plain, */*',\n    'Content-Type': 'application/json;charset=UTF-8' // 'Content-Type': 'application/x-www-form-urlencoded'\n\n  };\n  return fetch(commonUrl + url, options, {\n    credentials: 'include'\n  }).then(checkStatus).then(parseJSON).catch(err => ({\n    err\n  }));\n} // import React from 'react'\n// import request from './helper.js'\n// class RequestDemo extends React.Component{\n//   componentDidMount(){\n//     request({\n//       url:'/posttest',\n//       method:'post',\n//       data:{\"Header\":{\"AccessToken\":\"eyJ0eXBlIjoiSldUIiwiYWxnIjoiSFM1MTIifQ.eyJzdWIiOiIxMDYiLCJleHBpciI6MTUxMDczODAzNjA5MiwiaXNzIjoiIn0.eo000vRNb_zQOibg_ndhlWbi27hPt3KaDwVk7lQiS5NJ4GS4esaaXxfoCbRc7-hjlyQ8tY_NZ24BTVLwUEoXlA\"},\"Body\":{}}\n//     }).then(function(res){\n//       console.log(res)\n//     })\n//   }\n//   render(){\n//     return (\n//       <div>\n//     test\n//       </div>\n//     )\n//   }\n// }\n// export default RequestDemo","map":{"version":3,"sources":["/Users/yangkin/Desktop/project/react/todolist_koa/src/utils/fetch.js"],"names":["commonUrl","localStorage","setItem","parseJSON","response","json","checkStatus","status","error","Error","statusText","loginReq","data","options","method","made","body","JSON","stringify","headers","fetch","credentials","then","res","retCode","retBody","AccessToken","catch","err","reqwest","url","mode"],"mappings":"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","sourcesContent":["const commonUrl = 'http://127.0.0.1:3100'\nlocalStorage.setItem(\"access_token\",\"test\")\n\nfunction parseJSON(response){\n  return response.json()\n}\n\nfunction checkStatus(response){\n  if(response.status >= 200 && response.status < 500){\n    return response\n  }\n  const error = new Error(response.statusText)\n  error.response = response\n  throw error\n}\n  \n  /**\n   * 登录请求\n   * \n   * @param data 数据\n   */\n  export function loginReq(data){ \n    const options = {}\n    options.method = 'post'\n    options.made = 'cors'\n    options.body = JSON.stringify(data)\n    options.headers={\n      'Content-Type':'application/json'\n    }\n    return fetch('/loginOk',options,{credentials:'include'})\n      .then(checkStatus)\n      .then(parseJSON)\n      .then((res)=>{\n        if(res.retCode === '0001'){\n          localStorage.setItem('x-access-token',res.retBody.AccessToken)\n          return 'success'\n        }\n        else if(res.retCode === '0002'){\n          return 'error'\n        }\n        else if(res.retCode === '0003'){\n          return 'error'\n        }else{\n          return ;\n        }\n        \n      })\n      .catch(err=>({err}))\n  }\n  \n  /**\n   * 普通请求\n   * @param {*url,*method,*data} options \n   */\n \nexport default function reqwest(options = {}){\n  // const Authorization = localStorage.getItem('access_token')\n  const {data,url} = options\n  options = {...options}\n  options.mode = 'cors'\n  delete options.url\n  if(data){\n    delete options.data\n    options.body = JSON.stringify({\n      data\n    })\n  }\n \n  options.headers={\n     'Access-Control-Allow-Origin': '*',\n    // 'Authorization':Authorization,\n    // 'Accept': 'application/json, text/plain, */*',\n    'Content-Type':'application/json;charset=UTF-8'\n    // 'Content-Type': 'application/x-www-form-urlencoded'\n  }\n  return fetch(commonUrl+url,options,{credentials: 'include'})\n    .then(checkStatus)\n    .then(parseJSON)\n    .catch(err=>({err}))\n}\n\n// import React from 'react'\n// import request from './helper.js'\n// class RequestDemo extends React.Component{\n//   componentDidMount(){\n//     request({\n//       url:'/posttest',\n//       method:'post',\n//       data:{\"Header\":{\"AccessToken\":\"eyJ0eXBlIjoiSldUIiwiYWxnIjoiSFM1MTIifQ.eyJzdWIiOiIxMDYiLCJleHBpciI6MTUxMDczODAzNjA5MiwiaXNzIjoiIn0.eo000vRNb_zQOibg_ndhlWbi27hPt3KaDwVk7lQiS5NJ4GS4esaaXxfoCbRc7-hjlyQ8tY_NZ24BTVLwUEoXlA\"},\"Body\":{}}\n//     }).then(function(res){\n//       console.log(res)\n//     })\n//   }\n//   render(){\n//     return (\n//       <div>\n//     test\n//       </div>\n//     )\n//   }\n// }\n// export default RequestDemo"]},"metadata":{},"sourceType":"module"}